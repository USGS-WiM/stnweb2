<h2 mat-dialog-title>
    Peak Summary
    <button class="close-button" mat-button [mat-dialog-close]="returnData" aria-label="Exit"><mat-icon>close</mat-icon></button>
</h2>
<div [hidden]="!loading" class="loading">
    <mat-spinner style="margin:0 auto; top: 50%" mode="indeterminate" diameter="20"></mat-spinner>
</div>
<form [formGroup]="form" (ngSubmit)="submit()">
    <mat-dialog-content>
        <label
            class="filter-label"
            aria-label="Select data used for interpretation"
            >Select data used for interpretation:</label
        >
        <section class="checkbox-section">
            <div *ngFor="let hwm of hwms">
                <mat-checkbox
                    aria-checked="false"
                    class="checkbox-margin"
                    formControlName="hwm"
                    >HWM {{hwm.hwm_label}} {{hwm.elev_ft}} ft</mat-checkbox
                >
            </div>
        </section>
        <mat-divider></mat-divider>
        <section class="checkbox-section">
            <div *ngFor="let sensor of sensors">
                <label
                    class="filter-label"
                    aria-label="Select sensor files"
                    >{{sensor.deploymentType}}</label
                >
                <div *ngFor="let file of sensor.files">
                    <mat-checkbox
                        aria-checked="false"
                        class="checkbox-margin"
                        formControlName="sensor"
                        >{{file.name}}</mat-checkbox
                    >
                </div>
            </div>
        </section>
        <mat-divider></mat-divider>
        <section>
            <mat-form-field appearance="fill">
                <mat-label for="peak_calc_notes">Peak Calculation Notes</mat-label>
                <textarea aria-label="Peak Calculation Notes" matInput formControlName="calc_notes" id="peak_calc_notes" [value]="peak.calc_notes"></textarea>
                <mat-icon matSuffix class="info-icon" matTooltip="Please document the reason this peak was chosen for this event." 
                    aria-label="Displays a tooltip when focused or hovered over">info</mat-icon>
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Peak Date</mat-label>
                <input aria-label="Peak Date" matInput formControlName="peak_date" [value]="peak.peak_date" [matDatepicker]="peakDatePicker" required placeholder="Choose a date">
                <mat-datepicker-toggle matSuffix [for]="peakDatePicker"></mat-datepicker-toggle>
                <mat-datepicker [value]="peak.peak_date" #peakDatePicker></mat-datepicker>
            </mat-form-field>
            <!-- <mat-checkbox
                aria-checked="false"
                class="checkbox-margin"
                formControlName="is_peak_date_estimated"
                >Date Estimated?</mat-checkbox
            > -->
            <mat-checkbox
                aria-checked="false"
                class="checkbox-margin"
                formControlName="is_peak_time_estimated"
                >Time Estimated?</mat-checkbox
            >
            <mat-form-field appearance="fill">
                <mat-label>Peak Recorded In</mat-label>
                <mat-select required aria-label="Time Zone" formControlName="time_zone" (selectionChange)="setTimeZone()">
                    <mat-option *ngFor="let zone of timeZones" [value]="zone">
                    {{zone}}
                    </mat-option>
                </mat-select>
                <mat-icon matSuffix class="info-icon" matTooltip="Date/Time will be stored in UTC."
                aria-label="Displays a tooltip when focused or hovered over">info</mat-icon>
            </mat-form-field>
            <div>
                <label class="form-header">Preview time in UTC: </label> {{peak.utc_preview}}
            </div>
            <mat-form-field appearance="fill">
                <mat-label>Peak Stage (elevation ft)</mat-label>
                <input aria-label="Peak Stage" matInput formControlName="peak_stage" [value]="peak.peak_stage"/>
            </mat-form-field>
            <mat-checkbox
                aria-checked="false"
                class="checkbox-margin"
                formControlName="is_peak_stage_estimated"
                >Peak Stage Estimated?</mat-checkbox
            >
            <mat-form-field appearance="fill">
                <mat-label>Vertical Datum</mat-label>
                <mat-select aria-label="Vertical Datum" formControlName="vdatum_id">
                    <mat-option *ngFor="let datum of vdatums" [value]="datum.datum_id">
                    {{datum.datum_name}}
                    </mat-option>
                </mat-select>
            </mat-form-field>
            <mat-form-field appearance="fill">
                <mat-label>Height Above Ground (Depth of water in ft)</mat-label>
                <input aria-label="Height Above Ground" matInput formControlName="height_above_gnd" [value]="peak.height_above_gnd"/>
            </mat-form-field>
            <mat-checkbox
            aria-checked="false"
            class="checkbox-margin"
            formControlName="height_above_gnd_estimated"
            >Height Above Ground Estimated?</mat-checkbox
        >
        </section>
        <section>
            <mat-card>
                <!-- <mat-form-field appearance="fill">
                    <mat-label>Peak Discharge</mat-label>
                    <input aria-label="Peak Discharge" matInput formControlName="peak_discharge" [value]="peak.peak_discharge"/>
                </mat-form-field> -->
                <mat-checkbox
                    aria-checked="false"
                    class="checkbox-margin"
                    formControlName="is_peak_discharge_estimated"
                    >Peak Discharge Estimated?</mat-checkbox
                >
                <mat-form-field appearance="fill">
                    <mat-label>AEP</mat-label>
                    <input aria-label="AEP" matInput formControlName="aep" [value]="peak.aep"/>
                </mat-form-field>
                <mat-form-field appearance="fill">
                    <mat-label>AEP Confidence Interval (Lower Limit)</mat-label>
                    <input aria-label="AEP Confidence Interval (Lower Limit)" matInput formControlName="aep_lower_limit" [value]="peak.aep_lower_limit"/>
                </mat-form-field>
                <mat-form-field appearance="fill">
                    <mat-label>AEP Confidence Interval (Upper Limit)</mat-label>
                    <input aria-label="AEP Confidence Interval (Upper Limit)" matInput formControlName="aep_upper_limit" [value]="peak.aep_upper_limit"/>
                </mat-form-field>
                <mat-form-field appearance="fill">
                    <mat-label>AEP Confidence Interval (Percentage of Limits)</mat-label>
                    <input aria-label="AEP Confidence Interval (Percentage of Limits)" matInput formControlName="aep_percentage" [value]="peak.aep_percentage"/>
                </mat-form-field>
            </mat-card>
        </section>
    </mat-dialog-content>
    <mat-dialog-actions align="end">
        <div class="detail-section-buttons centered">
            <button mat-stroked-button class="close-btn" [mat-dialog-close]="returnData" cdkFocusInitial aria-label="Close">Close</button>
        </div>
    </mat-dialog-actions>
</form>
