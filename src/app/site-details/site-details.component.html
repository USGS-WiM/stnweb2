<div id="siteDetailsContainer">
    <div id="progress" *ngIf="noSiteInfo === undefined; else displaySiteContents">
        <mat-spinner style="margin:0 auto;" mode="indeterminate" diameter="20"></mat-spinner>
    </div>

    <ng-template #displaySiteContents>
        <div class=site-title>
            <div *ngIf="site !== undefined">
                Site {{site.site_no}} ({{event}})
            </div>
        </div>
        <div *ngIf="!noSiteInfo; else noSiteInfoAvailable">
            <mat-tab-group>
                <mat-tab label="Site">
                    <div class="basic-site-info">
                        <div id="siteMap">
                            <button mat-button class="map-button" (click)="toggleSiteMap()">
                                <span *ngIf="siteMapHidden">View site on map <mat-icon class="expand-icon">expand_more</mat-icon></span>
                                <span *ngIf="!siteMapHidden">Hide map <mat-icon class="expand-icon">expand_less</mat-icon></span>
                            </button>
                        </div>
                        <div id="mapContainer">
                            <mat-accordion id="legend">
                                <mat-expansion-panel id="legend-expansion" expanded="true">
                                    <mat-expansion-panel-header id="legend-header">
                                        Legend
                                    </mat-expansion-panel-header>
                                    <div id="legend-content">
                                        <div class="legend-row" *ngIf="nearbySitesVisible">
                                            <mat-checkbox [(ngModel)]="nearbyToggled" (change)="toggleNearby()">
                                                <div
                                                class="
                                                    legend-icon wmm-pin wmm-altblue wmm-icon-circle wmm-icon-altblue wmm-size-15
                                                "
                                                ></div>
                                                <p>Nearby Sites</p>
                                            </mat-checkbox>
                                        </div>
                                        <div class="legend-row" *ngIf="site !== undefined">
                                            <div
                                                class="
                                                    legend-icon wmm-pin wmm-altblue wmm-icon-circle wmm-icon-white wmm-size-20
                                                "
                                            ></div>
                                            <p>Site</p>
                                        </div>
                                        <div class="legend-row" *ngIf="hwm.length > 0">
                                            <div
                                            class="
                                                legend-icon wmm-diamond wmm-altred wmm-icon-noicon wmm-icon-red wmm-size-15
                                            "
                                            ></div>
                                            <p>High Water Mark</p>
                                        </div>
                                        <div class="legend-row" *ngIf="baroSensorVisible">
                                            <div
                                                class="
                                                    legend-icon wmm-square wmm-yellow wmm-icon-noicon wmm-icon-yellow wmm-size-15
                                                "
                                            ></div>
                                            <p>Barometric Pressure </p>
                                        </div>
                                        <div class="legend-row" *ngIf="airTempSensorVisible">
                                            <div
                                                class="
                                                    legend-icon wmm-circle wmm-yellow wmm-icon-noicon wmm-icon-yellow wmm-size-15
                                                "
                                            ></div>
                                            <p>Air Temperature</p>
                                        </div>
                                        <div class="legend-row" *ngIf="waterTempSensorVisible">
                                            <div
                                                class="
                                                    legend-icon wmm-square wmm-orange wmm-icon-noicon wmm-icon-orange wmm-size-15
                                                "
                                            ></div>
                                            <p>Water Temperature</p>
                                        </div>
                                        <div class="legend-row" *ngIf="rdgSensorVisible">
                                            <div
                                                class="
                                                    legend-icon wmm-square wmm-green wmm-icon-noicon wmm-icon-green wmm-size-15
                                                "
                                            ></div>
                                            <p>Rapid Deployment</p>
                                        </div>
                                        <div class="legend-row" *ngIf="thermSensorVisible">
                                            <div
                                                class="
                                                    legend-icon wmm-circle wmm-orange wmm-icon-noicon wmm-icon-orange wmm-size-15
                                                "
                                            ></div>
                                            <p>Temperature</p>
                                        </div>
                                        <div class="legend-row" *ngIf="waveSensorVisible">
                                            <div
                                                class="
                                                    legend-icon wmm-square wmm-blue wmm-icon-noicon wmm-icon-blue wmm-size-15
                                                "
                                            ></div>
                                            <p>Wave Height</p>
                                        </div>
                                        <div class="legend-row" *ngIf="stormSensorVisible">
                                            <div
                                                class="
                                                    legend-icon wmm-square wmm-purple wmm-icon-noicon wmm-icon-purple wmm-size-15
                                                "
                                            ></div>
                                            <p>Water Level</p>
                                        </div>
                                        <div class="legend-row" *ngIf="humiditySensorVisible">
                                            <div
                                                class="
                                                    legend-icon wmm-circle wmm-green wmm-icon-noicon wmm-icon-green wmm-size-15
                                                "
                                            ></div>
                                            <p>Humidity</p>
                                        </div>
                                        <div class="legend-row" *ngIf="windSensorVisible">
                                            <div
                                                class="
                                                    legend-icon wmm-circle wmm-purple wmm-icon-noicon wmm-icon-purple wmm-size-15
                                                "
                                            ></div>
                                            <p>Windspeed</p>
                                        </div>
                                        <div class="legend-row" *ngIf="otherSensorVisible">
                                            <div
                                                class="
                                                    legend-icon wmm-circle wmm-white wmm-icon-noicon wmm-icon-white wmm-size-15
                                                "
                                            ></div>
                                            <p>No deployment type specified</p>
                                        </div>
                                    </div>
                                </mat-expansion-panel>
                            </mat-accordion>
                        </div>
                        <div class="outer-content" *ngIf="site !== undefined">
                            <div class="cell-container">
                                <p class="content-left">Site Description</p>
                                <p class="content-right" *ngIf="site.site_description !== '' && site.site_description !== undefined; else nullSiteDesc">{{site.site_description}}</p>
                                <ng-template #nullSiteDesc><p class="content-right">---</p></ng-template>
                            </div>
                            <div class="cell-container">
                                <p class="content-left">Created By</p>
                                <p class="content-right" *ngIf="site.member_id !== '' && site.member_id !== undefined && memberName !== undefined; else nullMember">{{memberName}}</p>
                                <ng-template #nullMember><p class="content-right">---</p></ng-template>
                            </div>
                            <div class="cell-container">
                                <p class="content-left">Waterbody</p>
                                <p class="content-right" *ngIf="site.waterbody !== '' && site.waterbody !== undefined; else nullWaterbody">{{site.waterbody}}</p>
                                <ng-template #nullWaterbody><p class="content-right">---</p></ng-template>
                            </div>
                            <div class="cell-container">
                                <p class="content-left">Drainage Area</p>
                                <p class="content-right" *ngIf="site.drainage_area_sqmi !== '' && site.drainage_area_sqmi !== undefined; else nullDrainage">{{site.drainage_area_sqmi}}</p>
                                <ng-template #nullDrainage><p class="content-right">---</p></ng-template>
                            </div>
                            <div class="cell-container">
                                <p class="content-left">Station ID (USGS)</p>
                                <p class="content-right" *ngIf="site.usgs_sid !== '' && site.usgs_sid !== undefined; else nullUSGS">{{site.usgs_sid}}</p>
                                <ng-template #nullUSGS><p class="content-right">---</p></ng-template>
                            </div>
                            <div class="cell-container">
                                <p class="content-left">Station ID (NOAA)</p>
                                <p class="content-right" *ngIf="site.noaa_sid !== '' && site.noaa_sid !== undefined; else nullNOAA">{{site.noaa_sid}}</p>
                                <ng-template #nullNOAA><p class="content-right">---</p></ng-template>
                            </div>
                            <div class="cell-container">
                                <p class="content-left">Station ID (Other)</p>
                                <p class="content-right" *ngIf="site.other_sid !== '' && site.noaa_sid !== undefined; else nullOther">{{site.other_sid}}</p>
                                <ng-template #nullOther><p class="content-right">---</p></ng-template>
                            </div>
                        </div>
                    </div>
                    <mat-accordion multi="true">
                        <!-- Location Information -->
                        <mat-expansion-panel hideToggle expanded="true">
                            <mat-expansion-panel-header class="panel-headers">
                                <mat-panel-title>
                                    Location Information
                                </mat-panel-title> 
                            </mat-expansion-panel-header> 
                            <div class="table-container">
                                <div class="outer-content" *ngIf="site !== undefined">
                                    <div class="cell-container">
                                        <p class="content-left">Address</p>
                                        <p class="content-right" *ngIf="site.address !== '' && site.address !== undefined; else nullAddress">{{site.address}}</p>
                                        <ng-template #nullAddress><p class="content-right">---</p></ng-template>
                                    </div>
                                    <div class="cell-container">
                                        <p class="content-left">City</p>
                                        <p class="content-right" *ngIf="site.city !== '' && site.city !== undefined; else nullCity">{{site.city}}</p>
                                        <ng-template #nullCity><p class="content-right">---</p></ng-template>
                                    </div>
                                    <div class="cell-container">
                                        <p class="content-left">State</p>
                                        <p class="content-right" *ngIf="site.state !== '' && site.state !== undefined; else nullState">{{site.state}}</p>
                                        <ng-template #nullState><p class="content-right">---</p></ng-template>
                                    </div>
                                    <div class="cell-container">
                                        <p class="content-left">County</p>
                                        <p class="content-right" *ngIf="site.county !== '' && site.county !== undefined; else nullCounty">{{site.county}}</p>
                                        <ng-template #nullCounty><p class="content-right">---</p></ng-template>
                                    </div>
                                    <div class="cell-container">
                                        <p class="content-left">Zip</p>
                                        <p class="content-right" *ngIf="site.zip !== '' && site.zip !== undefined; else nullZip">{{site.zip}}</p>
                                        <ng-template #nullZip><p class="content-right">---</p></ng-template> 
                                    </div>
                                </div>
                            </div>
                            <div class="table-container">
                                <div class="outer-content" *ngIf="site !== undefined">
                                    <div class="cell-container">
                                        <p class="content-left">Latitude</p>
                                        <p class="content-right" *ngIf="site.latitude_dd !== '' && site.latitude_dd !== undefined; else nullLat">{{site.latitude_dd.toFixed(2)}}</p>
                                        <ng-template #nullLat><p class="content-right">---</p></ng-template>
                                    </div>
                                    <div class="cell-container">
                                        <p class="content-left">Longitude</p>
                                        <p class="content-right" *ngIf="site.longitude_dd !== '' && site.longitude_dd !== undefined; else nullLon">{{site.longitude_dd.toFixed(2)}}</p>
                                        <ng-template #nullLon><p class="content-right">---</p></ng-template>
                                    </div>
                                    <div class="cell-container">
                                        <p class="content-left">Horizontal Datum</p>
                                        <p class="content-right" *ngIf="site.hdatum_id !== '' && site.hdatum_id !== undefined; else nullHdatum">{{hdatum}}</p>
                                        <ng-template #nullHdatum><p class="content-right">---</p></ng-template>
                                    </div>
                                    <div class="cell-container">
                                        <p class="content-left">Collection Method</p>
                                        <p class="content-right" *ngIf="site.hcollect_method_id !== '' && site.hcollect_method_id !== undefined; else nullHcollect">{{hmethod}}</p>
                                        <ng-template #nullHcollect><p class="content-right">---</p></ng-template>
                                    </div>
                                </div>
                            </div>
                        <!-- </mat-expansion-panel> -->
                        <!-- Site Housing -->
                        <!-- <mat-expansion-panel hideToggle expanded="true">
                            <mat-expansion-panel-header class="panel-headers">
                                <mat-panel-title>
                                    Site Housing
                                </mat-panel-title>
                            </mat-expansion-panel-header> -->
                            <div class="tableContainer" *ngIf="site !== undefined && siteHousing !== undefined; else noTable">
                                <table *ngIf="siteHousing.length > 0; else noTable"
                                    mat-table
                                    id="siteHousingTable"
                                    [dataSource]="siteHousing"
                                    class="mat-elevation-z5"
                                    matSort
                                >

                                    <!-- site name column -->
                                    <ng-container matColumnDef="HousingType">
                                        <th mat-header-cell *matHeaderCellDef>Housing Type</th>
                                        <td mat-cell *matCellDef="let housing">
                                            <div *ngIf="housing.housing_type_id === '' || housing.housing_type_id === undefined || housing.housingType === undefined; else displayHousingType">
                                                ---
                                            </div>
                                            <ng-template #displayHousingType>
                                                {{ housing.housingType }}
                                            </ng-template>
                                        </td>
                                    </ng-container>

                                    <!-- site city column -->
                                    <ng-container matColumnDef="HousingLength">
                                        <th mat-header-cell *matHeaderCellDef>Housing Length</th>
                                        <td mat-cell *matCellDef="let housing">
                                            <div *ngIf="housing.length === '' || housing.length === undefined; else displayHousingLength">
                                                ---
                                            </div>
                                            <ng-template #displayHousingLength>
                                                {{ housing.length }} ft
                                            </ng-template>
                                        </td>
                                    </ng-container>

                                    <!-- site id column -->
                                    <ng-container matColumnDef="HousingMaterial">
                                        <th mat-header-cell *matHeaderCellDef>Housing Material</th>
                                        <td mat-cell *matCellDef="let housing">
                                            <div *ngIf="housing.material === '' || housing.material === undefined; else displayHousingMaterial">
                                                ---
                                            </div>
                                            <ng-template #displayHousingMaterial>
                                                {{ housing.material }}
                                            </ng-template>
                                        </td>
                                    </ng-container>

                                    <!-- site description column -->
                                    <ng-container matColumnDef="Amount">
                                        <th
                                            mat-header-cell
                                            style="margin-right: 25px"
                                            *matHeaderCellDef
                                        >
                                            Amount
                                        </th>
                                        <td
                                            mat-cell
                                            style="margin-right: 25px"
                                            *matCellDef="let housing"
                                        >
                                            <div *ngIf="housing.amount === '' || housing.amount === undefined; else displayAmount">
                                                ---
                                            </div>
                                            <ng-template #displayAmount>
                                                {{ housing.amount }}
                                            </ng-template>
                                        </td>
                                    </ng-container>

                                    <!-- site city column -->
                                    <ng-container matColumnDef="Notes">
                                        <th mat-header-cell *matHeaderCellDef>Notes</th>
                                        <td mat-cell *matCellDef="let housing">
                                            <div *ngIf="housing.notes === '' || housing.notes === undefined; else displayNotes">
                                                ---
                                            </div>
                                            <ng-template #displayNotes>
                                                {{ housing.notes }}
                                            </ng-template>
                                        </td>
                                    </ng-container>

                                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                    <tr
                                        mat-row
                                        *matRowDef="let row; columns: displayedColumns"
                                        class="results-noclick-row"
                                    ></tr>
                                </table>
                            </div>
                            <ng-template #noTable>
                                <div class="table-container">
                                    <div class="outer-content">
                                        <div class="cell-container">
                                            <p class="content-left">Housing Type Information</p>
                                            <p class="content-right">---</p>
                                        </div>
                                    </div>
                                </div>
                            </ng-template>
                            <div class="table-container">
                                <div class="outer-content" *ngIf="site !== undefined">
                                    <div class="cell-container">
                                        <p class="content-left">Network Type</p>
                                        <p class="content-right" *ngIf="networkType !== undefined; else nullNetworkType">{{networkType}}</p>
                                        <ng-template #nullNetworkType><p class="content-right">---</p></ng-template>
                                    </div>
                                    <div class="cell-container">
                                        <p class="content-left">Network</p>
                                        <p class="content-right" *ngIf="networkName !== undefined; else nullNetwork">{{networkName}}</p>
                                        <ng-template #nullNetwork><p class="content-right">---</p></ng-template>
                                    </div>
                                    <div class="cell-container">
                                        <p class="content-left">Zone</p>
                                        <p class="content-right" *ngIf="site.zone !== '' && site.zone !== undefined; else nullZone">{{site.zone}}</p>
                                        <ng-template #nullZone><p class="content-right">---</p></ng-template>
                                    </div>
                                    <div class="cell-container">
                                        <p class="content-left">Sensor Not Appropriate</p>
                                        <p class="content-right" *ngIf="site.sensor_not_appropriate !== '' && site.sensor_not_appropriate !== undefined; else nullSensorApp">{{site.sensor__not_appropriate}}</p>
                                        <ng-template #nullSensorApp><p class="content-right">---</p></ng-template>
                                    </div>
                                    <div class="cell-container">
                                        <p class="content-left">Permanent Housing</p>
                                        <p class="content-right" *ngIf="site.is_permanent_housing_installed !== '' && site.is_permanent_housing_installed !== undefined; else nullPermHousing">{{site.is_permanent_housing_installed}}</p>
                                        <ng-template #nullPermHousing><p class="content-right">---</p></ng-template>
                                    </div>
                                    <div class="cell-container">
                                        <p class="content-left">Safety Notes</p>
                                        <p class="content-right" *ngIf="site.safety_notes !== '' && site.safety_notes !== undefined; else nullSafetyNotes">{{site.safety_notes}}</p>
                                        <ng-template #nullSafetyNotes><p class="content-right">---</p></ng-template>
                                    </div>
                                </div>
                            </div>
                            <div class="table-container">
                                <div class="outer-content" *ngIf="site !== undefined">
                                    <mat-card class="cell-container" id="landowner">
                                        <p id="landownerTitle">Land Owner Contact</p>
                                        <div>
                                            <div class="cell-container">
                                                <p class="content-left">First Name</p>
                                                <p class="content-right" *ngIf="landownerContact !== undefined && landownerContact.fname !== '' && landownerContact.fname !== undefined; else nullLandownerFname">{{landownerContact.fname}}</p>    
                                                <ng-template #nullLandownerFname><p class="content-right">---</p></ng-template>
                                            </div>
                                            <div class="cell-container">
                                                <p class="content-left">Last Name</p>
                                                <p class="content-right" *ngIf="landownerContact !== undefined && landownerContact.lname !== '' && landownerContact.lname !== undefined; else nullLandownerLname">{{landownerContact.lname}}</p>             
                                                <ng-template #nullLandownerLname><p class="content-right">---</p></ng-template>
                                            </div>
                                            <div class="cell-container">
                                                <p class="content-left">Affiliation/Title</p>
                                                <p class="content-right" *ngIf="landownerContact !== undefined && landownerContact.title !== '' && landownerContact.title !== undefined; else nullLandownerTitle">{{landownerContact.title}}</p>
                                                <ng-template #nullLandownerTitle><p class="content-right">---</p></ng-template>
                                            </div>
                                            <div class="cell-container">
                                                <p class="content-left">Address</p>
                                                <p class="content-right" *ngIf="landownerContact !== undefined && landownerContact.address !== '' && landownerContact.address !== undefined; else nullLandownerAddress">{{landownerContact.address}}</p>
                                                <ng-template #nullLandownerAddress><p class="content-right">---</p></ng-template>
                                            </div>
                                            <div class="cell-container">
                                                <p class="content-left">City</p>
                                                <p class="content-right" *ngIf="landownerContact !== undefined && landownerContact.city !== '' && landownerContact.city !== undefined; else nullLandownerCity">{{landownerContact.city}}</p>
                                                <ng-template #nullLandownerCity><p class="content-right">---</p></ng-template>
                                            </div>
                                            <div class="cell-container">
                                                <p class="content-left">State</p>
                                                <p class="content-right" *ngIf="landownerContact !== undefined && landownerContact.state !== '' && landownerContact.state !== undefined; else nullLandownerState">{{landownerContact.state}}</p>
                                                <ng-template #nullLandownerState><p class="content-right">---</p></ng-template>
                                            </div>
                                            <div class="cell-container">
                                                <p class="content-left">Zip</p>
                                                <p class="content-right" *ngIf="landownerContact !== undefined && landownerContact.zip !== '' && landownerContact.zip !== undefined; else nullLandownerZip">{{landownerContact.zip}}</p>
                                                <ng-template #nullLandownerZip><p class="content-right">---</p></ng-template>
                                            </div>
                                            <div class="cell-container">
                                                <p class="content-left">Primary Phone</p>
                                                <p class="content-right" *ngIf="landownerContact !== undefined && landownerContact.primaryphone !== '' && landownerContact.primaryphone !== undefined; else nullLandownerPrimaryphone">{{landownerContact.primaryphone}}</p>
                                                <ng-template #nullLandownerPrimaryphone><p class="content-right">---</p></ng-template>
                                            </div>
                                            <div class="cell-container">
                                                <p class="content-left">Secondary Phone</p>
                                                <p class="content-right" *ngIf="landownerContact !== undefined && landownerContact.secondaryphone !== '' && landownerContact.secondaryphone !== undefined; else nullLandownerSecondaryphone">{{landownerContact.secondaryphone}}</p>
                                                <ng-template #nullLandownerSecondaryphone><p class="content-right">---</p></ng-template>
                                            </div>
                                            <div class="cell-container">
                                                <p class="content-left">Email</p>
                                                <p class="content-right" *ngIf="landownerContact !== undefined && landownerContact.email !== '' && landownerContact.email !== undefined; else nullLandownerEmail">{{landownerContact.email}}</p>
                                                <ng-template #nullLandownerEmail><p class="content-right">---</p></ng-template>
                                            </div>
                                        </div>
                                    </mat-card>
                                </div> 
                            </div>
                        </mat-expansion-panel>
                        <!-- Additional Information -->
                        <mat-expansion-panel hideToggle expanded="true">
                            <mat-expansion-panel-header class="panel-headers">
                                <mat-panel-title>
                                    Additional Information
                                </mat-panel-title>
                            </mat-expansion-panel-header>
                            <div class="table-container">
                                <div class="outer-content" *ngIf="site !== undefined">
                                    <div class="cell-container">
                                        <p class="content-left">Internal Notes</p>
                                        <p class="content-right" *ngIf="site.site_notes !== '' && site.site_notes !== undefined; else nullSiteNotes">{{site.site_notes}}</p>
                                        <ng-template #nullSiteNotes><p class="content-right">---</p></ng-template>
                                    </div>
                                    <div class="cell-container">
                                        <p class="content-left">Permission Granted</p>
                                        <p class="content-right" *ngIf="site.access_granted !== '' && site.access_granted !== undefined; else nullPermission">{{site.access_granted}}</p>
                                        <ng-template #nullPermission><p class="content-right">---</p></ng-template>
                                    </div>
                                </div>
                            </div>
                        </mat-expansion-panel>
                    </mat-accordion>
                </mat-tab>
                <mat-tab label="Reference Marks ({{referenceMarks.length}})">
                    <div class="tableContainer" *ngIf="referenceMarks !== undefined; else noRMTable">
                        <table *ngIf="referenceMarks.length > 0; else noRMTable"
                            mat-table
                            id="datumLocTable"
                            [dataSource]="refMarkDataSource"
                            class="mat-elevation-z5"
                            (matSortChange)="sortData($event)"
                            matSort
                        >

                            <!-- reference mark name column -->
                            <ng-container matColumnDef="RefMarkName">
                                <th mat-header-cell *matHeaderCellDef>Name</th>
                                <td mat-cell *matCellDef="let rm">
                                    <div *ngIf="rm.name === '' || rm.name === undefined; else displayReferenceMark">
                                        ---
                                    </div>
                                    <ng-template #displayReferenceMark>
                                        {{ rm.name }}
                                    </ng-template>
                                </td>
                            </ng-container>

                            <!-- reference elevation column -->
                            <ng-container matColumnDef="RefMarkEl">
                                <th mat-header-cell *matHeaderCellDef>Elevation</th>
                                <td mat-cell *matCellDef="let rm">
                                    <div *ngIf="rm.elev_ft === '' || rm.elev_ft === undefined; else displayReferenceMarkEl">
                                        ---
                                    </div>
                                    <ng-template #displayReferenceMarkEl>
                                        {{ rm.elev_ft }}
                                    </ng-template>
                                </td>
                            </ng-container>

                            <tr mat-header-row *matHeaderRowDef="displayedRMColumns"></tr>
                            <tr
                                mat-row
                                *matRowDef="let row; columns: displayedRMColumns"
                                (click)="openRefMarkDetailsDialog(row)"
                                class="results-row"
                            ></tr>
                        </table>
                        <ng-template #noRMTable>
                            <p class="tableContainer">No Reference Marks listed.</p>
                        </ng-template>
                    </div>
                    <mat-paginator [hidden]="referenceMarks === undefined || referenceMarks.length === 0" #paginator [pageSizeOptions]="[5, 10, 25]" class="results-paginator"></mat-paginator>
                </mat-tab>
                <mat-tab label="Sensors ({{siteFullInstruments.length}})">
                    <mat-card class="mat-elevation-z0 event-alert" *ngIf="currentEvent === 0"><mat-icon class="warning-icon">warning</mat-icon><p>To deploy or retrieve a sensor, first choose an Event above.</p></mat-card>
                    <div class="tableContainer" *ngIf="siteFullInstruments !== undefined; else noSensorTable">
                        <table *ngIf="siteFullInstruments.length > 0; else noSensorTable"
                            mat-table
                            id="sensorTable"
                            [dataSource]="sensorDataSource"
                            class="mat-elevation-z5"
                            matSort
                        >
                            <!-- serial number column -->
                            <ng-container matColumnDef="SerialNumber" >
                                <th mat-header-cell *matHeaderCellDef>Serial Number</th>
                                <td mat-cell *matCellDef="let sensor">
                                    <div *ngIf="sensor.serial_number === '' || sensor.serial_number === undefined; else displaySerialNum">
                                        ---
                                    </div>
                                    <ng-template #displaySerialNum>
                                        {{ sensor.serial_number }}
                                    </ng-template>
                                </td>
                            </ng-container>

                            <!-- sensor event column -->
                            <ng-container matColumnDef="SensorEvent">
                                <th mat-header-cell *matHeaderCellDef>Event</th>
                                <td mat-cell *matCellDef="let sensor">
                                    <div *ngIf="sensor.eventName === undefined || sensor.eventName === ''; else displaySensorEvent">
                                        ---
                                    </div>
                                    <ng-template #displaySensorEvent>
                                        {{ sensor.eventName }}
                                    </ng-template>
                                </td>
                            </ng-container>

                            <!-- sensor type column -->
                            <ng-container matColumnDef="DeploymentType">
                                <th mat-header-cell *matHeaderCellDef>Deployment Type</th>
                                <td mat-cell *matCellDef="let sensor">
                                    <div *ngIf="sensor.deploymentType === '' || sensor.deploymentType === undefined; else displayDeploymentType">
                                        ---
                                    </div>
                                    <ng-template #displayDeploymentType>
                                        {{ sensor.deploymentType }}
                                    </ng-template>
                                </td>
                            </ng-container>

                            <!-- sensor status column -->
                            <ng-container matColumnDef="SensorStatus">
                                <th mat-header-cell *matHeaderCellDef>Status</th>
                                <td mat-cell *matCellDef="let sensor">
                                    <div *ngIf="sensor.statusType === '' || sensor.statusType === undefined; else displayStatusType">
                                        ---
                                    </div>
                                    <ng-template #displayStatusType>
                                        <mat-icon class="deployed-icon" *ngIf="sensor.statusType === 'Deployed'">check_circle</mat-icon>
                                        {{ sensor.statusType }}
                                    </ng-template>
                                </td>
                            </ng-container>

                            <tr mat-header-row *matHeaderRowDef="displayedSensorColumns"></tr>
                            <tr
                                mat-row
                                *matRowDef="let row; columns: displayedSensorColumns"
                                (click)="openSensorDetailsDialog(row)"
                                class="results-row"
                            ></tr>
                        </table>
                        <ng-template #noSensorTable>
                            <p class="tableContainer">No Sensors listed.</p>
                        </ng-template>
                    </div>
                    <mat-paginator [hidden]="siteFullInstruments === undefined || siteFullInstruments.length === 0" #sensorPaginator [pageSizeOptions]="[5, 10, 25]" class="results-paginator"></mat-paginator>
                </mat-tab>
                <mat-tab label="High Water Marks ({{hwm.length}})">
                    <mat-card class="mat-elevation-z0 event-alert" *ngIf="currentEvent === 0"><mat-icon class="warning-icon">warning</mat-icon><p>To create a HWM, first choose an Event above.</p></mat-card>
                    <div class="tableContainer" *ngIf="hwm !== undefined; else noHWMTable">
                        <table *ngIf="hwm.length > 0; else noHWMTable"
                            mat-table
                            id="hwmTable"
                            [dataSource]="hwmDataSource"
                            class="mat-elevation-z5"
                            matSort
                        >
                            <!-- hwm ID column -->
                            <ng-container matColumnDef="HwmID">
                                <th mat-header-cell *matHeaderCellDef>HWM ID</th>
                                <td mat-cell *matCellDef="let mark">
                                    <div *ngIf="mark.hwm_id === '' || mark.hwm_id === undefined; else displayHWMID">
                                        ---
                                    </div>
                                    <ng-template #displayHWMID>
                                        {{ mark.hwm_id }}
                                    </ng-template>
                                </td>
                            </ng-container>

                            <!-- hwm label column -->
                            <ng-container matColumnDef="HwmLabel">
                                <th mat-header-cell *matHeaderCellDef>Label</th>
                                <td mat-cell *matCellDef="let mark">
                                    <div *ngIf="mark.hwm_label === '' || mark.hwm_label === undefined; else displayHWMLabel">
                                        ---
                                    </div>
                                    <ng-template #displayHWMLabel>
                                        {{ mark.hwm_label }}
                                    </ng-template>
                                </td>
                            </ng-container>

                            <!-- hwm flag date column -->
                            <ng-container matColumnDef="HwmFlagDate">
                                <th mat-header-cell *matHeaderCellDef>Flag Date</th>
                                <td mat-cell *matCellDef="let mark">
                                    <div *ngIf="mark.flag_date === '' || mark.flag_date === undefined; else displayFlagDate">
                                        ---
                                    </div>
                                    <ng-template #displayFlagDate>
                                        {{ mark.flag_date }}
                                    </ng-template>
                                </td>
                            </ng-container>

                            <!-- hwm elevation column -->
                            <ng-container matColumnDef="HwmElev">
                                <th mat-header-cell *matHeaderCellDef>Elevation</th>
                                <td mat-cell *matCellDef="let mark">
                                    <div *ngIf="mark.elev_ft === '' || mark.elev_ft === undefined; else displayElev">
                                        ---
                                    </div>
                                    <ng-template #displayElev>
                                        {{mark.elev_ft}}ft
                                    </ng-template>
                                </td>
                            </ng-container>

                            <tr mat-header-row *matHeaderRowDef="displayedHWMColumns"></tr>
                            <tr
                                mat-row
                                *matRowDef="let row; columns: displayedHWMColumns"
                                (click)="openHWMDetailsDialog(row)"
                                class="results-row"
                            ></tr>
                        </table>
                        <ng-template #noHWMTable>
                            <p class="tableContainer">No HWMs listed.</p>
                        </ng-template>
                    </div>
                    <mat-paginator [hidden]="hwm === undefined || hwm.length === 0" #hwmPaginator [pageSizeOptions]="[5, 10, 25]" class="results-paginator"></mat-paginator>
                </mat-tab>
                <mat-tab label="Peaks ({{peaks.length}})">
                    <mat-card class="mat-elevation-z0 event-alert" *ngIf="currentEvent === 0"><mat-icon class="warning-icon">warning</mat-icon><p>To view details about a Peak Summary, first choose an Event above.</p></mat-card>
                    <div class="tableContainer" *ngIf="peaks !== undefined; else noPeakTable">
                        <table *ngIf="peaks.length > 0; else noPeakTable"
                            mat-table
                            id="peakTable"
                            [dataSource]="peaksDataSource"
                            class="mat-elevation-z5"
                            matSort
                        >
                            <!-- peak stage column -->
                            <ng-container matColumnDef="PeakStage">
                                <th mat-header-cell *matHeaderCellDef>Stage</th>
                                <td mat-cell *matCellDef="let peak">
                                    <div *ngIf="peak.peak_stage === '' || peak.peak_stage === undefined; else displayPeakStage">
                                        ---
                                    </div>
                                    <ng-template #displayPeakStage>
                                        {{ peak.peak_stage }}
                                    </ng-template>
                                </td>
                            </ng-container>

                            <!-- peak event name column -->
                            <ng-container matColumnDef="PeakEventName">
                                <th mat-header-cell *matHeaderCellDef>Event Name</th>
                                <td mat-cell *matCellDef="let peak">
                                    <div *ngIf="peak.event_name === '' || peak.event_name === undefined; else displayPeakEvent">
                                        ---
                                    </div>
                                    <ng-template #displayPeakEvent>
                                        {{ peak.event_name }}
                                    </ng-template>
                                </td>
                            </ng-container>

                            <!-- peak date column -->
                            <ng-container matColumnDef="PeakDate">
                                <th mat-header-cell *matHeaderCellDef>Date</th>
                                <td mat-cell *matCellDef="let peak">
                                    <div *ngIf="peak.peak_date === '' || peak.peak_date === undefined; else displayPeakDate">
                                        ---
                                    </div>
                                    <ng-template #displayPeakDate>
                                        {{ peak.peak_date }}
                                    </ng-template>
                                </td>
                            </ng-container>

                            <tr mat-header-row *matHeaderRowDef="displayedPeakColumns"></tr>
                            <tr
                                mat-row
                                *matRowDef="let row; columns: displayedPeakColumns"
                                (click)="openPeaksDetailsDialog(row, 'Peak')"
                                class="results-noclick-row"
                            ></tr>
                        </table>
                        <ng-template #noPeakTable>
                            <p class="tableContainer">No Peaks listed.</p>
                        </ng-template>
                    </div>
                    <mat-paginator [hidden]="peaks === undefined || peaks.length === 0" #peaksPaginator [pageSizeOptions]="[5, 10, 25]" class="results-paginator"></mat-paginator>
                </mat-tab>
                <mat-tab label="Files ({{fileLength}})">
                    <mat-accordion multi="true">
                        <!-- Files -->
                        <mat-expansion-panel hideToggle>
                            <mat-expansion-panel-header class="panel-headers">
                                <mat-panel-title>
                                    Site Files ({{siteFiles.length}})
                                </mat-panel-title>
                            </mat-expansion-panel-header>
                            <div class="tableContainer" *ngIf="siteFiles !== undefined; else noSiteFileTable">
                                <table *ngIf="siteFiles.length > 0; else noSiteFileTable"
                                    mat-table
                                    id="siteFilesTable"
                                    [dataSource]="siteFilesDataSource"
                                    class="mat-elevation-z5"
                                    matSort
                                >
                                    <!-- site file date column -->
                                    <ng-container matColumnDef="FileDate">
                                        <th mat-header-cell *matHeaderCellDef>File Date</th>
                                        <td mat-cell *matCellDef="let file">
                                            <div *ngIf="file.file_date === '' || file.file_date === undefined; else displaySiteFileDate">
                                                ---
                                            </div>
                                            <ng-template #displaySiteFileDate>
                                                {{ file.file_date }}
                                            </ng-template>
                                        </td>
                                    </ng-container>

                                    <!-- site file name column -->
                                    <ng-container matColumnDef="FileName">
                                        <th mat-header-cell *matHeaderCellDef>File Name</th>
                                        <td mat-cell *matCellDef="let file">
                                            <div *ngIf="file.name === '' || file.name === undefined; else displaySiteFileName">
                                                ---
                                            </div>
                                            <ng-template #displaySiteFileName>
                                                {{ file.name }}
                                            </ng-template>
                                        </td>
                                    </ng-container>

                                    <tr mat-header-row *matHeaderRowDef="displayedSiteFileColumns"></tr>
                                    <tr
                                        mat-row
                                        *matRowDef="let row; columns: displayedSiteFileColumns"
                                        (click)="openFileDetailsDialog(row, 'Site File')"
                                        class="results-row"
                                    ></tr>
                                </table>
                            </div>
                            <ng-template #noSiteFileTable>
                                <p class="tableContainer">No Site Files listed.</p>
                            </ng-template>
                            <mat-paginator [hidden]="siteFiles === undefined || siteFiles.length === 0" #siteFilesPaginator [pageSizeOptions]="[5, 10, 25]" class="results-paginator"></mat-paginator>
                        </mat-expansion-panel>
                        <mat-expansion-panel hideToggle>
                            <mat-expansion-panel-header class="panel-headers">
                                <mat-panel-title>
                                    Reference Mark Files ({{datumLocFiles.length}})
                                </mat-panel-title>
                            </mat-expansion-panel-header>
                            <div class="tableContainer" *ngIf="datumLocFiles !== undefined; else noDatumFileTable">
                                <table *ngIf="datumLocFiles.length > 0; else noDatumFileTable"
                                    mat-table
                                    id="datumLocFilesTable"
                                    [dataSource]="refMarkFilesDataSource"
                                    class="mat-elevation-z5"
                                    matSort
                                >
                                    <!-- datum file date column -->
                                    <ng-container matColumnDef="FileDate">
                                        <th mat-header-cell *matHeaderCellDef>File Date</th>
                                        <td mat-cell *matCellDef="let file">
                                            <div *ngIf="file.file_date === '' || file.file_date === undefined; else displayDatumFileDate">
                                                ---
                                            </div>
                                            <ng-template #displayDatumFileDate>
                                                {{ file.file_date }}
                                            </ng-template>
                                        </td>
                                    </ng-container>

                                    <!-- datum file name column -->
                                    <ng-container matColumnDef="FileName">
                                        <th mat-header-cell *matHeaderCellDef>File Name</th>
                                        <td mat-cell *matCellDef="let file">
                                            <div *ngIf="file.name === '' || file.name === undefined; else displayDatumFileName">
                                                ---
                                            </div>
                                            <ng-template #displayDatumFileName>
                                                {{ file.name }}
                                            </ng-template>
                                        </td>
                                    </ng-container>

                                    <!-- datum file datum column -->
                                    <ng-container matColumnDef="FileDatum">
                                        <th mat-header-cell *matHeaderCellDef>Reference Mark</th>
                                        <td mat-cell *matCellDef="let file">
                                            <div *ngIf="file.datum_name === '' || file.datum_name === undefined; else displayDatumFileDatum">
                                                ---
                                            </div>
                                            <ng-template #displayDatumFileDatum>
                                                {{ file.datum_name }}
                                            </ng-template>
                                        </td>
                                    </ng-container>

                                    <tr mat-header-row *matHeaderRowDef="displayedDatumFileColumns"></tr>
                                    <tr
                                        mat-row
                                        *matRowDef="let row; columns: displayedDatumFileColumns"
                                        (click)="openFileDetailsDialog(row, 'Reference Mark File')"
                                        class="results-row"
                                    ></tr>
                                </table>
                            </div>
                            <ng-template #noDatumFileTable>
                                <p class="tableContainer">No Reference Mark Files listed.</p>
                            </ng-template>
                            <mat-paginator [hidden]="datumLocFiles === undefined || datumLocFiles.length === 0" #refMarkFilesPaginator [pageSizeOptions]="[5, 10, 25]" class="results-paginator"></mat-paginator>
                        </mat-expansion-panel>
                        <mat-expansion-panel hideToggle>
                            <mat-expansion-panel-header class="panel-headers">
                                <mat-panel-title>
                                    Sensor Files ({{sensorFiles.length}})
                                </mat-panel-title>
                            </mat-expansion-panel-header>
                            <div class="tableContainer" *ngIf="sensorFiles !== undefined; else noSensorFileTable">
                                <table *ngIf="sensorFiles.length > 0 && sensorFilesDone; else noSensorFileTable"
                                    mat-table
                                    id="sensorFilesTable"
                                    [dataSource]="sensorFilesDataSource"
                                    class="mat-elevation-z5"
                                    matSort
                                >
                                    <!-- Sensor file date column -->
                                    <ng-container matColumnDef="FileDate">
                                        <th mat-header-cell *matHeaderCellDef>File Date</th>
                                        <td mat-cell *matCellDef="let file">
                                            <div *ngIf="file.file_date === '' || file.file_date === undefined; else displaySensorFileDate">
                                                ---
                                            </div>
                                            <ng-template #displaySensorFileDate>
                                                {{ file.file_date }}
                                            </ng-template>
                                        </td>
                                    </ng-container>

                                    <!-- Sensor file name column -->
                                    <ng-container matColumnDef="FileName">
                                        <th mat-header-cell *matHeaderCellDef>File Name</th>
                                        <td mat-cell *matCellDef="let file">
                                            <div *ngIf="file.name === '' || file.name === undefined; else displaySensorFileName">
                                                ---
                                            </div>
                                            <ng-template #displaySensorFileName>
                                                {{ file.name }}
                                            </ng-template>
                                        </td>
                                    </ng-container>

                                    <!-- Sensor file serial number column -->
                                    <ng-container matColumnDef="FileSerialNum">
                                        <th mat-header-cell *matHeaderCellDef>Sensor Serial Number</th>
                                        <td mat-cell *matCellDef="let file">
                                            <div *ngIf="file.details.serial_number === '' || file.details.serial_number === undefined; else displaySensorFileSerial">
                                                ---
                                            </div>
                                            <ng-template #displaySensorFileSerial>
                                                {{ file.details.serial_number }}
                                            </ng-template>
                                        </td>
                                    </ng-container>

                                    <tr mat-header-row *matHeaderRowDef="displayedSensorFileColumns"></tr>
                                    <tr
                                        mat-row
                                        *matRowDef="let row; columns: displayedSensorFileColumns"
                                        (click)="openFileDetailsDialog(row, 'Sensor File')"
                                        class="results-row"
                                    ></tr>
                                </table>
                            </div>
                            <ng-template #noSensorFileTable>
                                <p class="tableContainer">No Sensor Files listed.</p>
                            </ng-template>
                            <mat-paginator [hidden]="sensorFiles === undefined || sensorFiles.length === 0" #sensorFilesPaginator [pageSizeOptions]="[5, 10, 25]" class="results-paginator"></mat-paginator>
                        </mat-expansion-panel>
                        <mat-expansion-panel hideToggle>
                            <mat-expansion-panel-header class="panel-headers">
                                <mat-panel-title>
                                    HWM Files ({{hwmFiles.length}})
                                </mat-panel-title>
                            </mat-expansion-panel-header>
                            <div class="tableContainer" *ngIf="hwmFiles !== undefined; else noHWMFileTable">
                                <table *ngIf="hwmFiles.length > 0; else noHWMFileTable"
                                    mat-table
                                    id="hwmFilesTable"
                                    [dataSource]="hwmFilesDataSource"
                                    class="mat-elevation-z5"
                                    matSort
                                >
                                    <!-- HWM file date column -->
                                    <ng-container matColumnDef="FileDate">
                                        <th mat-header-cell *matHeaderCellDef>File Date</th>
                                        <td mat-cell *matCellDef="let file">
                                            <div *ngIf="file.file_date === '' || file.file_date === undefined; else displayHWMFileDate">
                                                ---
                                            </div>
                                            <ng-template #displayHWMFileDate>
                                                {{ file.file_date }}
                                            </ng-template>
                                        </td>
                                    </ng-container>

                                    <!-- HWM file name column -->
                                    <ng-container matColumnDef="FileName">
                                        <th mat-header-cell *matHeaderCellDef>File Name</th>
                                        <td mat-cell *matCellDef="let file">
                                            <div *ngIf="file.name === '' || file.name === undefined; else displayHWMFileName">
                                                ---
                                            </div>
                                            <ng-template #displayHWMFileName>
                                                {{ file.name }}
                                            </ng-template>
                                        </td>
                                    </ng-container>

                                    <tr mat-header-row *matHeaderRowDef="displayedHWMFileColumns"></tr>
                                    <tr
                                        mat-row
                                        *matRowDef="let row; columns: displayedHWMFileColumns"
                                        (click)="openFileDetailsDialog(row, 'HWM File')"
                                        class="results-row"
                                    ></tr>
                                </table>
                            </div>
                            <ng-template #noHWMFileTable>
                                <p class="tableContainer">No HWM Files listed.</p>
                            </ng-template>
                            <mat-paginator [hidden]="hwmFiles === undefined || hwmFiles.length === 0" #hwmFilesPaginator [pageSizeOptions]="[5, 10, 25]" class="results-paginator"></mat-paginator>
                        </mat-expansion-panel>
                    </mat-accordion>
                </mat-tab>
            </mat-tab-group>
        </div>
        <ng-template #noSiteInfoAvailable>
            <p><b>404 Page Not Found</b></p>
            <p>The content you are looking for cannot be found.</p>
            <p>Check your URL or return to the <a [routerLink]="['../../../map']">homepage.</a></p>
        </ng-template>
    </ng-template>
</div>